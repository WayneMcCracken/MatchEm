package  {		import flash.display.MovieClip;	import flash.text.TextFormat;	import flash.events.Event;	import flash.events.MouseEvent;			public class Preloader extends MovieClip {				public var pokeball: Pokeball = new Pokeball();		public var playBut: MenuButton = new MenuButton(25, 115, 9);		public var aboutBut: MenuButton = new MenuButton(25, 250, 9);		public var mainBut: MenuButton = new MenuButton(490, -1 , 4);		public var backBut: MenuButton;		public var about: AboutPage;		private var inAbout: Boolean = false;		private var gameInitialized: Boolean = false;				private var loading: LoadProgress;		private var titleBox = new TextBox("Match Em'!", 15, 0, 640, 210);		private var titleFormat = new TextFormat("Calibri", 56, 0x000000);		private var subtitleBox = new TextBox("A Pokémon matching game.", 20, 60, 290, 50);		private var subtitleFormat = new TextFormat("Calibri", 16, 0x666666);		private var versionBox = new TextBox("Version 1.00 <Q1-2012>", 10, 460, 200, 20)				public function Preloader() {			init();		}				private function init(): void {			//DRAW OBJECTS TO STAGE			//Add animated pokeball.			addChild(pokeball);			//Add title TextBox.			titleBox.setTextFormat(titleFormat);			addChild(titleBox);			//Add subtitle TextBox.			subtitleBox.setTextFormat(subtitleFormat);			addChild(subtitleBox);			//Add version TextBox.			addChild(versionBox);			//Add MenuButtons.			addChild(playBut);			addChild(aboutBut);				organizeLoad();						mainBut.width = 40; mainBut.height = 20;		}				private function organizeLoad(): void {			loading = new LoadProgress();			addChild(loading);			loading.addEventListener("loadComplete", onLoadFinished);		}				private function onLoadFinished(e: Event): void {			trace("LoadFinished");			loading.removeEventListener(Event.COMPLETE, onLoadFinished);			removeChild(pokeball);			playBut.buttonMode = true; aboutBut.buttonMode = true;			playBut.gotoAndStop(1); aboutBut.gotoAndStop(2);			playBut.addEventListener(MouseEvent.CLICK, onPlay);			playBut.addEventListener(MouseEvent.MOUSE_OVER, onPlayHover);			aboutBut.addEventListener(MouseEvent.CLICK, onAbout);			aboutBut.addEventListener(MouseEvent.MOUSE_OVER, onAboutHover);		}				private function onPlay(e: MouseEvent): void {			trace("onPlay called.");			gameInitialized = true;			playBut.removeEventListener(MouseEvent.CLICK, onPlay);			playBut.removeEventListener(MouseEvent.MOUSE_OVER, onPlayHover);			playBut.removeEventListener(MouseEvent.MOUSE_OUT, onAway);			aboutBut.removeEventListener(MouseEvent.CLICK, onAbout);			aboutBut.removeEventListener(MouseEvent.MOUSE_OVER, onAboutHover);			aboutBut.removeEventListener(MouseEvent.MOUSE_OUT, onAway);			playBut.gotoAndStop(1); aboutBut.gotoAndStop(2);						//Initialize game.			addChild(loading.loader);			addChild(mainBut);			mainBut.addEventListener(MouseEvent.MOUSE_OVER, onMainHover);			mainBut.buttonMode = true;			mainBut.gotoAndStop(4);		}				private function onBack(e: MouseEvent): void {			trace("Back to menu.");			inAbout = false;			backBut.removeEventListener(MouseEvent.CLICK, onBack);			removeChild(backBut);			removeChild(about);		}				private function onAbout(e: MouseEvent): void {			trace("onAbout called.");			inAbout = true;						backBut = new MenuButton(170, 3, 3);			backBut.buttonMode = true;			backBut.addEventListener(MouseEvent.CLICK, onBack);			backBut.addEventListener(MouseEvent.MOUSE_OVER, onBackHover);						about = new AboutPage();			addChild(about);			addChild(backBut);			backBut.width = 75; backBut.height = 30;		}				private function onPlayHover(e: MouseEvent): void {			playBut.gotoAndStop(5);			playBut.addEventListener(MouseEvent.MOUSE_OUT, onAway);		}				private function onAboutHover(e: MouseEvent): void {			aboutBut.gotoAndStop(6);			aboutBut.addEventListener(MouseEvent.MOUSE_OUT, onAway);		}				private function onBackHover(e: MouseEvent): void {			backBut.gotoAndStop(7);			backBut.addEventListener(MouseEvent.MOUSE_OUT, onAway);		}				private function onAway(e: MouseEvent): void {			if (contains(playBut) && contains(aboutBut) && inAbout == false && gameInitialized == false) {			playBut.removeEventListener(MouseEvent.MOUSE_OUT, onAway);			playBut.gotoAndStop(1);			aboutBut.removeEventListener(MouseEvent.MOUSE_OUT, onAway);			aboutBut.gotoAndStop(2);			return;				}						if (contains(backBut) && inAbout == true && gameInitialized == false) {				backBut.removeEventListener(MouseEvent.MOUSE_OUT, onAway);				backBut.gotoAndStop(3);				}						if (contains(mainBut) && gameInitialized == true) {				mainBut.removeEventListener(MouseEvent.MOUSE_OUT, onAway);				mainBut.gotoAndStop(4);			}		}				//BACK BUTTON LOGIC		private function onMainHover(e: MouseEvent): void {			mainBut.addEventListener(MouseEvent.CLICK, onMainClick);			mainBut.addEventListener(MouseEvent.MOUSE_OUT, onAway);			mainBut.gotoAndStop(8);		}				private function onMainClick(e: MouseEvent): void {			trace("Going back to main.");			gameInitialized = false;			mainBut.removeEventListener(MouseEvent.CLICK, onMainClick);			mainBut.removeEventListener(MouseEvent.MOUSE_OUT, onAway);			mainBut.removeEventListener(MouseEvent.MOUSE_OVER, onMainHover);			removeChild(mainBut);			removeChild(loading.loader);			loading.loader.unload();			loading = new LoadProgress();			playBut.addEventListener(MouseEvent.CLICK, onPlay);			playBut.addEventListener(MouseEvent.MOUSE_OVER, onPlayHover);			aboutBut.addEventListener(MouseEvent.CLICK, onAbout);			aboutBut.addEventListener(MouseEvent.MOUSE_OVER, onAboutHover);		}			}	}